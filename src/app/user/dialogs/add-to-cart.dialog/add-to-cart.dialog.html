<div style="width: min(550px, 90vw);">
  <div mat-dialog-title style="display: flex; align-items: center;">
    <span style="font-weight: 700; font-size: 18px;">Detalle del plato</span>
  </div>
  <mat-dialog-content style="display: flex; flex-direction: column; gap: 8px; overflow: visible;">
    <div style="display: grid; grid-template-columns: 100px 1fr; height: 100px">
      <div style="display: flex; align-items: center; justify-content: center; background: #ffffff;">
        @if (data.branchDish.dish.imageUrl !== '') {
          <img [src]="data.branchDish.dish.imageUrl" alt="Imagen del plato" style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;"/>
        } @else {
          <div style="display: flex; flex-direction: column; align-items: center;">
            <mat-icon>image</mat-icon>
            <span>Sin imagen</span>
          </div>
        }
      </div>
      <div style="display: flex; flex-direction: column; gap: 6px; margin-left: 5px">
        <div style="display: flex; justify-content: space-between; font-weight: 700;">
          <span style="font-size: 16px;">{{ data.branchDish.dish.name }}</span>
          <span style="">S/. {{ data.branchDish.customPrice || data.branchDish.dish.basePrice | number:'1.2-2' }}</span>
        </div>
        <span style="font-size: 13px;">{{ data.branchDish.dish.description }}</span>
      </div>
    </div>
    <mat-divider></mat-divider>
    @if (extraBranchDishes.length > 0) {
      <div style="display: flex; flex-direction: column; gap: 8px;">
        <span style="font-weight: 700;">Extras</span>
        <div style="display: flex; flex-direction: column; gap: 8px;">
          @for (extra of extraBranchDishes; track extra.id) {
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 10px; border: 1px solid #eee; border-radius: 8px; background: #fff;">
              <mat-checkbox
                [checked]="extra.selected"
                (change)="onExtraChange(extra, $event.checked)">
                <span style="font-weight: 600;">{{ extra.extraBranch.extra.name }}</span>
              </mat-checkbox>
              <span style="font-weight: 600;">S/. {{ (extra.customPrice || extra.extraBranch.extra.basePrice) | number:'1.2-2' }}</span>
            </div>
          }
        </div>
      </div>
      <mat-divider></mat-divider>
    }
    <mat-form-field appearance="outline" subscriptSizing="dynamic" style="width: 75%">
      <mat-label>Comentario para cocina</mat-label>
      <input matInput [(ngModel)]="orderItem.comment"/>
      <mat-hint>Ej. sin cebolla (opcional)</mat-hint>
    </mat-form-field>
    <div style="display: flex; justify-content: space-between;">
      <div style="display: flex; align-items: center;">
        <button mat-icon-button color="primary" matTooltip="Disminuir" (click)="decrement()" [disabled]="orderItem.quantity == 1">
          <mat-icon>remove_circle_outline</mat-icon>
        </button>
        <span style="min-width: 28px; text-align: center; font-weight: 700;">{{ orderItem.quantity }}</span>
        <button mat-icon-button matTooltip="Aumentar" (click)="increment()">
          <mat-icon>add_circle_outline</mat-icon>
        </button>
      </div>
      <div style="display: flex; flex-direction: column; align-items: flex-end;">
        <span style="font-size: 12px;">Subtotal: S/. {{ orderItem.unitPrice | number:'1.2-2' }}</span>
        <span style="font-weight: 800; font-size: 16px;">Total: S/. {{ orderItem.total | number:'1.2-2' }}</span>
      </div>
    </div>
  </mat-dialog-content>
  <mat-dialog-actions>
    <button mat-button mat-dialog-close>Cancelar</button>
    <button matButton="filled" (click)="addItemToCart()">
      Agregar ({{orderItem.quantity}})
    </button>
  </mat-dialog-actions>
</div>
